import numpy as np
import matplotlib.pyplot as plt

g_rhs = np.array([-1.39035e-02,2.67838e-03,-6.10114e-04,1.83382e-04,-5.90929e-05,1.26729e-05,-5.37025e-06,1.05014e-06,-1.36319e-07,2.16767e-08,-1.59501e-09,8.50705e-11])
cpp_soln = np.array([-2.21345e-03,1.81756e-03,-5.94386e-04,1.62557e-04,-7.12396e-05,2.06332e-05,-8.71118e-06,1.17148e-06,-1.76779e-07,2.16949e-08,-1.71602e-09,8.32158e-11])
H = np.array([6.28135e+00,2.17168e+00,-4.07264e+00,-2.89067e+00,-2.73921e+00,1.17444e+00,7.50228e-01,-2.58769e-01,9.85943e-01,-3.31270e+00,1.05184e+00,1.18151e-01,0.00000e+00,1.47361e+00,1.50326e+00,-1.12131e-02,-1.72812e-01,1.08854e+00,-5.71957e-01,-2.68403e-01,-6.14744e-01,-5.13172e-01,-3.11051e-01,-2.79346e-01,0.00000e+00,0.00000e+00,1.02646e+00,4.27503e-01,-1.78277e-01,2.27982e-01,-6.72395e-02,-1.55730e-04,-1.80262e-01,-9.74940e-02,-3.07996e-02,-6.17172e-02,0.00000e+00,0.00000e+00,0.00000e+00,1.12811e+00,4.48302e-01,8.93278e-01,-5.01751e-01,-2.59288e-01,-4.92248e-01,-1.84987e-01,-2.53253e-01,-2.81741e-01,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,8.29495e-01,7.90279e-01,-1.50474e-01,-1.40964e-01,-3.13114e-01,-1.16186e-01,-1.14682e-01,-1.24812e-01,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,6.14198e-01,7.34915e-01,1.26234e-01,1.19217e-01,2.80408e-01,-1.67810e-02,1.44005e-01,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,6.16477e-01,2.38106e-01,-2.33719e-01,-1.64283e-01,-1.61357e-01,-1.15175e-01,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,8.96420e-01,2.37384e-01,1.06226e-01,-9.24861e-03,5.45770e-02,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,7.71127e-01,2.17650e-01,-5.61532e-02,2.17692e-02,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,9.99158e-01,1.40095e-01,4.42230e-03,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,9.29482e-01,1.03351e-01,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,0.00000e+00,1.02229e+00])
n = g_rhs.shape[0]
H = H.reshape((n, n))

plt.imshow(H)
plt.show()

py_soln = np.linalg.solve(H, g_rhs)
print(f"{g_rhs=}")
print(f"{py_soln=}")
print(f"{cpp_soln=}")

detH = np.linalg.det(H)
print(f"{detH=}")