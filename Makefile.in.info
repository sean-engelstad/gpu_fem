# on local
HOME_DIR = ${HOME}
# on NAS
# HOME_DIR = # swbuild or different dir

A2D_DIR := ${HOME_DIR}/git/_archive/a2d
A2D_INCLUDE := -I${A2D_DIR}/include

GPU_FEM_DIR = ${HOME_DIR}/git/gpu_fem
GPU_FEM_INCLUDE = -I${GPU_FEM_DIR}/include
TACS_DIR = ${HOME_DIR}/git/_archive/tacs

# USE_GPU := 1
USE_GPU := 0
GPU_CXX = nvcc
CXX = g++
CC_FLAGS = -Wno-deprecated-declarations
CUSPARSE_LINK = -lcublas -lcusparse -lcudart -lcusolver
# GPU_CC_FLAGS := -O2 -arch=sm_86
# fast math use fuse intrinsics (fast) but can reduce precision, 
#   however with T = double the flag doesn't do anything
# GPU_CC_FLAGS := -O3 --use_fast_math -arch=sm_86 #-w
GPU_CC_FLAGS = -O3 -arch=sm_86
DEBUG_GPU_CC_FLAGS := -g ${GPU_CC_FLAGS}

# --relocatable-device-code=false -flto 
# alternative PTX optimization GPU flags
# GPU_CC_FLAGS := ${GPU_CC_FLAGS} -Xptxas -dlcm=ca -Xptxas -O3

# sparse-utils repo (smdogroup) and lapack, metis, etc.
SPARSE_UTILS_INCLUDE = -I${HOME_DIR}/git/_archive/sparse-utils/include/

PYBIND11_INCLUDE = -I/usr/include/python3.10 -I/home/seanfireball1/myenv/lib/python3.10/site-packages/pybind11/include

LAPACK_DIR := ${HOME_DIR}/git/_archive/lapack
LAPACK_INCLUDE := -I${LAPACK_DIR}/build/include/
LAPACK_LIB := -L${LAPACK_DIR}/build/lib/
LAPACK_LINK := ${LAPACK_LIB} -llapacke -llapack -lblas

# MPI include and lib, use 'mpicxx -show' to get the include and lib commands
MPI_INCLUDE = -I/usr/lib/x86_64-linux-gnu/openmpi/include -I/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi
MPI_LIB = -L/usr/lib/x86_64-linux-gnu/openmpi/lib -lmpi_cxx -lmpi

# on NAS
# MPI_INCLUDE = -I/nasa/nvidia/hpc_sdk/toss4/Linux_x86_64/23.11/comm_libs/openmpi/openmpi-3.1.5/include
# MPI_LIB = -L/nasa/nvidia/hpc_sdk/toss4/Linux_x86_64/23.11/comm_libs/openmpi/openmpi-3.1.5/lib -lmpi

# metis include and lib
METIS_DIR = ${TACS_DIR}/extern/metis
METIS_INCLUDE = -I${METIS_DIR}/include/
METIS_LIB = ${METIS_DIR}/lib/libmetis.a

INCLUDE_FLAGS = ${A2D_INCLUDE} ${GPU_FEM_INCLUDE} ${METIS_INCLUDE} ${SPARSE_UTILS_INCLUDE} ${LAPACK_INCLUDE} ${MPI_INCLUDE}
CPU_LINK = ${LAPACK_LINK} ${MPI_LIB}
LINK = ${LAPACK_LINK} ${CUSPARSE_LINK} ${MPI_LIB} ${METIS_LIB}