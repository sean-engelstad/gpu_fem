import matplotlib.pyplot as plt

class GMRES:
    def __init__(self, fill: int, iter, resids):
        self.fill = fill
        self.iter = iter
        self.resids = resids

gmres_list = []

gmres_list += [GMRES(
fill=3,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290],
resids=[1.494958193000000e+03, 1.494957449000000e+03, 1.494957022000000e+03, 1.494956376000000e+03, 1.494955077000000e+03, 1.494951687000000e+03, 1.494949384000000e+03, 1.494947427000000e+03, 1.494945842000000e+03, 1.494943284000000e+03, 1.494939224000000e+03, 1.494936676000000e+03, 1.494933350000000e+03, 1.494927214000000e+03, 1.494922427000000e+03, 1.494914078000000e+03, 1.494907100000000e+03, 1.494899670000000e+03, 1.494885488000000e+03, 1.494869573000000e+03, 1.494852341000000e+03, 1.494828120000000e+03, 1.494799174000000e+03, 1.494770570000000e+03, 1.494722633000000e+03, 1.494683537000000e+03, 1.494637934000000e+03, 1.494582332000000e+03, 1.494534459000000e+03, 1.494456372000000e+03],
)]

gmres_list += [GMRES(
fill=5,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290],
resids=[1.494958193000000e+03, 1.494954931000000e+03, 1.494951577000000e+03, 1.494943491000000e+03, 1.494937482000000e+03, 1.494928915000000e+03, 1.494918580000000e+03, 1.494902020000000e+03, 1.494880895000000e+03, 1.494851048000000e+03, 1.494827916000000e+03, 1.494799044000000e+03, 1.494761153000000e+03, 1.494738221000000e+03, 1.494699087000000e+03, 1.494656838000000e+03, 1.494618375000000e+03, 1.494560547000000e+03, 1.494461263000000e+03, 1.494344728000000e+03, 1.494245835000000e+03, 1.494094637000000e+03, 1.493918487000000e+03, 1.493776241000000e+03, 1.493687934000000e+03, 1.493671665000000e+03, 1.493657438000000e+03, 1.493638304000000e+03, 1.493621972000000e+03, 1.493604444000000e+03],
)]

gmres_list += [GMRES(
fill=7,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290],
resids=[1.494958146000000e+03, 1.494954275000000e+03, 1.494949548000000e+03, 1.494926021000000e+03, 1.494838519000000e+03, 1.494802876000000e+03, 1.494757220000000e+03, 1.494709690000000e+03, 1.494621190000000e+03, 1.494604884000000e+03, 1.494596367000000e+03, 1.494572594000000e+03, 1.494522662000000e+03, 1.494379004000000e+03, 1.494162737000000e+03, 1.493197089000000e+03, 1.492593226000000e+03, 1.492308814000000e+03, 1.492238219000000e+03, 1.492068811000000e+03, 1.491923349000000e+03, 1.491712108000000e+03, 1.491576123000000e+03, 1.491505707000000e+03, 1.491374560000000e+03, 1.491112744000000e+03, 1.490879293000000e+03, 1.490758914000000e+03, 1.490546255000000e+03, 1.490219904000000e+03],
)]

gmres_list += [GMRES(
fill=9,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290],
resids=[1.494958193000000e+03, 1.494923952000000e+03, 1.494801944000000e+03, 1.494719313000000e+03, 1.494646755000000e+03, 1.494601665000000e+03, 1.494407524000000e+03, 1.493220092000000e+03, 1.492517353000000e+03, 1.491412003000000e+03, 1.491018258000000e+03, 1.490597909000000e+03, 1.490311626000000e+03, 1.489872454000000e+03, 1.487460491000000e+03, 1.470877842000000e+03, 1.432629829000000e+03, 1.389286575000000e+03, 1.369864992000000e+03, 1.171247537000000e+03, 9.607554655000000e+02, 4.370034795000000e+02, 1.403542260000000e+01, 2.758369507000000e-01, 1.621632214000000e-02, 8.761332783000001e-05, 7.260140312000001e-05, 7.260133820000001e-05, 7.260120784000000e-05, 3.509334059000000e-05],
)]

gmres_list += [GMRES(
fill=10,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220],
resids=[1.494940252000000e+03, 1.494799474000000e+03, 1.494490173000000e+03, 1.493988427000000e+03, 1.493400903000000e+03, 1.492292966000000e+03, 1.491294433000000e+03, 1.490380371000000e+03, 1.488422521000000e+03, 1.484045704000000e+03, 1.430326313000000e+03, 1.331639371000000e+03, 1.216564579000000e+03, 1.180789460000000e+03, 5.575595118000000e+02, 3.081049876000000e+02, 1.515241667000000e+01, 3.627526354000000e-01, 1.834481237000000e-03, 2.273173847000000e-05, 1.868890898000000e-05, 1.868887522000000e-05, 1.868884394000000e-05],
)]

# Plotting
plt.figure(figsize=(8, 6))

for gmres in gmres_list:
    plt.semilogy(gmres.iter, gmres.resids, marker='o', label=f'fill = {gmres.fill}')

plt.xlabel('GMRES Iteration')
plt.ylabel('Residual Norm')
# plt.title('GMRES Convergence History')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.tight_layout()
# plt.show()
plt.savefig("out/ucrm-gmres-rgpu.png", dpi=400)
