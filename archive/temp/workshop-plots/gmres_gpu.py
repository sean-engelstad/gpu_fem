import matplotlib.pyplot as plt

class GMRES:
    def __init__(self, fill: int, iter, resids):
        self.fill = fill
        self.iter = iter
        self.resids = resids

gmres_list = []

gmres_list += [GMRES(
fill=3,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190],
resids=[1.031434800000000e+04, 1.030787272000000e+04, 1.021058084000000e+04, 1.012016883000000e+04, 1.003291738000000e+04, 9.995749694000000e+03, 9.954577061000000e+03, 9.913043164000001e+03, 9.797011628000000e+03, 9.698178613000000e+03, 9.656508003999999e+03, 9.619351495999999e+03, 9.556165593000000e+03, 9.524289478999999e+03, 9.502267003999999e+03, 9.437283018000000e+03, 9.414326427000000e+03, 9.376186433000001e+03, 9.268881511000000e+03, 9.209747846000000e+03],
)]

gmres_list += [GMRES(
fill=7,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170],
resids=[1.031471885000000e+04, 1.018522598000000e+04, 1.015040033000000e+04, 1.011986553000000e+04, 1.007641826000000e+04, 1.001627956000000e+04, 9.947791816000001e+03, 9.895468252000001e+03, 9.637612395000000e+03, 8.536357522000000e+03, 7.084382505000000e+03, 6.511572969000000e+03, 6.072088039000000e+03, 5.622426898000000e+03, 5.113310354000000e+03, 3.607198493000000e+03, 5.038238205000000e+00, 3.063378679000000e-03],
)]

gmres_list += [GMRES(
fill=11,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100],
resids=[1.031490747000000e+04, 1.028164657000000e+04, 1.025988115000000e+04, 1.019275909000000e+04, 9.960010039999999e+03, 7.120003078000000e+03, 4.247391553000000e+03, 3.203087180000000e+03, 1.614166818000000e+03, 1.995464958000000e+01, 4.697320066000000e-04],
)]

# Plotting
plt.figure(figsize=(8, 6))

for gmres in gmres_list:
    plt.semilogy(gmres.iter, gmres.resids, marker='o', label=f'fill = {gmres.fill}')

plt.xlabel('GMRES Iteration')
plt.ylabel('Residual Norm')
# plt.title('GMRES Convergence History')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.tight_layout()
# plt.show()
plt.savefig("out/ucrm-gmres.png", dpi=400)
