import matplotlib.pyplot as plt

class GMRES:
    def __init__(self, fill: int, iter, resids):
        self.fill = fill
        self.iter = iter
        self.resids = resids

gmres_list = []

gmres_list += [GMRES(
fill=3,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
resids=[1.494958190000000e+04, 1.491400070000000e+04, 1.480424750000000e+04, 1.459445120000000e+04, 1.455444520000000e+04, 1.451303770000000e+04, 1.450659870000000e+04, 1.442206090000000e+04, 1.421345900000000e+04, 1.403467860000000e+04, 1.382795120000000e+04, 1.369316160000000e+04, 1.351551530000000e+04, 1.341963750000000e+04, 1.337517990000000e+04, 1.335107500000000e+04, 1.329825530000000e+04, 1.322557850000000e+04, 1.313232280000000e+04, 1.304274460000000e+04, 1.292526940000000e+04],
)]

gmres_list += [GMRES(
fill=7,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180],
resids=[1.494958190000000e+04, 1.492011880000000e+04, 1.488912390000000e+04, 1.484743030000000e+04, 1.468216180000000e+04, 1.446564770000000e+04, 1.403684810000000e+04, 1.337914910000000e+04, 1.281459580000000e+04, 1.189052080000000e+04, 1.105503250000000e+04, 1.093833980000000e+04, 1.055714310000000e+04, 9.996146240000000e+03, 9.069214440000000e+03, 9.249934919999999e+02, 7.476211929999999e+01, 8.138184620000000e-01, 7.274588210000000e-04],
)]

gmres_list += [GMRES(
fill=11,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90],
resids=[1.494958190000000e+04, 1.494760120000000e+04, 1.492203400000000e+04, 1.490003940000000e+04, 1.458371900000000e+04, 1.193902700000000e+04, 9.831388269999999e+03, 8.866639010000001e+03, 5.274012410000000e+02, 1.715065100000000e+00],
)]

# Plotting
plt.figure(figsize=(8, 6))

for gmres in gmres_list:
    plt.semilogy(gmres.iter, gmres.resids, marker='o', label=f'fill = {gmres.fill}')

plt.xlabel('GMRES Iteration')
plt.ylabel('Residual Norm')
# plt.title('GMRES Convergence History')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.tight_layout()
# plt.show()
plt.savefig("out/ucrm-gmres-cpu.png", dpi=400)
