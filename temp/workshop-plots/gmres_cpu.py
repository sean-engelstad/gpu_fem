import matplotlib.pyplot as plt

class GMRES:
    def __init__(self, fill: int, iter, resids):
        self.fill = fill
        self.iter = iter
        self.resids = resids

gmres_list = []

gmres_list += [GMRES(
fill=3,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
resids=[1.494958190000000e+04, 1.489525710000000e+04, 1.474905880000000e+04, 1.456826360000000e+04, 1.453211150000000e+04, 1.448964310000000e+04, 1.443841000000000e+04, 1.430633820000000e+04, 1.410834220000000e+04, 1.392345610000000e+04, 1.376153350000000e+04, 1.366958000000000e+04, 1.349344740000000e+04, 1.342450950000000e+04, 1.337163760000000e+04, 1.333511060000000e+04, 1.325278240000000e+04, 1.319438640000000e+04, 1.313706180000000e+04, 1.304398350000000e+04, 1.297466140000000e+04, 1.282679250000000e+04, 1.211778900000000e+04, 1.129701020000000e+04, 1.067401400000000e+04, 1.009121740000000e+04, 9.278423500000001e+03, 8.944513970000000e+03, 8.627029810000000e+03, 8.274753300000000e+03, 7.902422160000000e+03],
)]

gmres_list += [GMRES(
fill=5,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270],
resids=[1.494958190000000e+04, 1.483062940000000e+04, 1.473123400000000e+04, 1.471602670000000e+04, 1.456843110000000e+04, 1.431878690000000e+04, 1.419636410000000e+04, 1.412082620000000e+04, 1.399575970000000e+04, 1.394432270000000e+04, 1.380190770000000e+04, 1.358058220000000e+04, 1.284392060000000e+04, 1.211423340000000e+04, 1.112269220000000e+04, 1.066156170000000e+04, 1.018158400000000e+04, 9.538093140000001e+03, 8.523614260000000e+03, 8.289220530000001e+03, 8.088230300000000e+03, 7.791005370000000e+03, 6.682201730000000e+03, 1.784038510000000e+03, 9.228340129999999e+01, 5.797283920000000e+00, 2.474713540000000e-02, 2.755130300000000e-05],
)]

gmres_list += [GMRES(
fill=7,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190],
resids=[1.494958190000000e+04, 1.492216430000000e+04, 1.488672480000000e+04, 1.483781580000000e+04, 1.463329320000000e+04, 1.447043860000000e+04, 1.411799940000000e+04, 1.373679240000000e+04, 1.303875620000000e+04, 1.208515630000000e+04, 1.159360910000000e+04, 1.119436100000000e+04, 1.074657250000000e+04, 1.054567670000000e+04, 8.928249140000000e+03, 2.545688650000000e+03, 9.676342180000000e+01, 1.944025660000000e+00, 8.487590340000000e-03, 2.336255660000000e-06],
)]

gmres_list += [GMRES(
fill=9,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140],
resids=[1.494958190000000e+04, 1.492405850000000e+04, 1.488554540000000e+04, 1.481163290000000e+04, 1.469000300000000e+04, 1.401819160000000e+04, 1.314693350000000e+04, 1.244496940000000e+04, 1.208593530000000e+04, 1.143313100000000e+04, 7.455173980000000e+03, 6.666076230000000e+02, 2.469374600000000e+01, 4.210812090000000e-02, 9.296802650000000e-06],
)]

# Plotting
plt.figure(figsize=(8, 6))

for gmres in gmres_list:
    plt.semilogy(gmres.iter, gmres.resids, marker='o', label=f'fill = {gmres.fill}')

plt.xlabel('GMRES Iteration')
plt.ylabel('Residual Norm')
# plt.title('GMRES Convergence History')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.tight_layout()
# plt.show()
plt.savefig("out/ucrm-gmres-cpu.png", dpi=400)
