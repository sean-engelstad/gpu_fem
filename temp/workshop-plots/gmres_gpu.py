import matplotlib.pyplot as plt

class GMRES:
    def __init__(self, fill: int, iter, resids):
        self.fill = fill
        self.iter = iter
        self.resids = resids

gmres_list = []

gmres_list += [GMRES(
    fill=3,
    iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290],
    resids=[8.055937521000000e+01, 1.134126239000000e+00, 5.104840264000000e-01, 2.905862515000000e-01, 2.154486499000000e-01, 1.742714390000000e-01, 1.491148900000000e-01, 1.262919537000000e-01, 1.119344663000000e-01, 1.006707444000000e-01, 8.751933421999999e-02, 7.858590662999999e-02, 6.873933878000001e-02, 5.820501378000000e-02, 4.838574818000000e-02, 4.083808998000000e-02, 3.315834565000000e-02, 2.614444287000000e-02, 2.144747789000000e-02, 1.868752128000000e-02, 1.620407178000000e-02, 1.438370774000000e-02, 1.305211811000000e-02, 1.205711574000000e-02, 1.115146785000000e-02, 1.007148888000000e-02, 9.125823845000000e-03, 8.374981833999999e-03, 7.648897549000000e-03, 7.045317911000000e-03],
)]

gmres_list += [GMRES(
    fill=5,
    iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290],
    resids=[2.359343267000000e+02, 1.150740111000000e+00, 3.792696556000000e-01, 1.923080532000000e-01, 1.542765996000000e-01, 1.320150415000000e-01, 1.127671368000000e-01, 8.087241695000000e-02, 5.954138452000000e-02, 3.784748366000000e-02, 2.479672685000000e-02, 1.760698422000000e-02, 1.403042026000000e-02, 1.198036530000000e-02, 1.043498799000000e-02, 8.711942157000000e-03, 7.722330699000000e-03, 7.146653588000000e-03, 6.572197567000000e-03, 6.008783903000000e-03, 5.667457820000000e-03, 5.328521892000000e-03, 5.074505859000000e-03, 4.749552299000000e-03, 4.357482758000000e-03, 4.070080627000000e-03, 3.831738844000000e-03, 3.640549937000000e-03, 3.425235137000000e-03, 3.258331911000000e-03]
)]

gmres_list += [GMRES(
fill=7,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290],
resids=[1.194787407000000e+00, 1.745593991000000e-01, 1.459113260000000e-01, 6.860390721000000e-02, 2.967596763000000e-02, 1.882729058000000e-02, 1.371316014000000e-02, 1.173761779000000e-02, 8.838057395000000e-03, 6.957272105000000e-03, 6.241856537000000e-03, 5.953720588000000e-03, 5.730048122000000e-03, 5.565879248000000e-03, 5.518669554000000e-03, 5.482643348000000e-03, 5.448898898000000e-03, 5.419035690000000e-03, 5.373192404000000e-03, 5.319334049000000e-03, 5.245496713000000e-03, 5.152863484000000e-03, 5.081089058000000e-03, 5.006817664000000e-03, 4.908217274000000e-03, 4.860156109000000e-03, 4.805150865000000e-03, 4.738655928000000e-03, 4.619397935000000e-03, 4.580469161000000e-03],
)]

gmres_list += [GMRES(
fill=9,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250],
resids=[1.023550537000000e+00, 9.699098892999999e-02, 3.864496142000000e-02, 2.317382277000000e-02, 1.776229340000000e-02, 1.545169028000000e-02, 1.430323264000000e-02, 1.252318110000000e-02, 1.057776274000000e-02, 9.641600651000001e-03, 9.160773019000000e-03, 8.480593074000000e-03, 8.282290651000000e-03, 7.645033510000000e-03, 4.531558642000000e-03, 2.503191479000000e-03, 1.983574789000000e-03, 8.400960315000000e-04, 7.255116329000000e-04, 6.316248866000000e-04, 3.322657217000000e-04, 2.359705628000000e-04, 1.425129843000000e-05, 1.533865107000000e-06, 5.691258035000000e-08, 3.007415040000000e-10],
)]

gmres_list += [GMRES(
    fill=10,
    iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190],
    resids=[3.548562590000000e-01, 8.485746844000000e-02, 3.423737754000000e-02, 2.507364978000000e-02, 2.235446661000000e-02, 1.928445734000000e-02, 1.688041046000000e-02, 1.527715053000000e-02, 1.412955469000000e-02, 9.931812809999999e-03, 3.148038911000000e-03, 1.905879264000000e-03, 1.026198089000000e-03, 6.230305269000000e-04, 3.055123176000000e-04, 1.696695340000000e-04, 1.759649155000000e-05, 4.483306123000000e-07, 7.406654291000000e-09, 2.852445630000000e-11]
)]

# Plotting
plt.figure(figsize=(8, 6))

for gmres in gmres_list:
    plt.semilogy(gmres.iter, gmres.resids, marker='o', label=f'fill = {gmres.fill}')

plt.xlabel('GMRES Iteration')
plt.ylabel('Residual Norm')
# plt.title('GMRES Convergence History')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.tight_layout()
# plt.show()
plt.savefig("out/ucrm-gmres.png", dpi=400)
