import matplotlib.pyplot as plt

class GMRES:
    def __init__(self, fill: int, iter, resids):
        self.fill = fill
        self.iter = iter
        self.resids = resids

gmres_list = []

gmres_list += [GMRES(
fill=0,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190],
resids=[1.494954087000000e+04, 1.494952705000000e+04, 1.494952664000000e+04, 1.494952348000000e+04, 1.494951746000000e+04, 1.494951154000000e+04, 1.494948536000000e+04, 1.494946089000000e+04, 1.494943533000000e+04, 1.494940468000000e+04, 1.494937362000000e+04, 1.494932514000000e+04, 1.494927315000000e+04, 1.494923972000000e+04, 1.494919999000000e+04, 1.494914488000000e+04, 1.494911232000000e+04, 1.494906098000000e+04, 1.494903031000000e+04, 1.494895258000000e+04],
)]

gmres_list += [GMRES(
fill=5,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190],
resids=[1.494875892000000e+04, 1.475415126000000e+04, 1.461151025000000e+04, 1.454934472000000e+04, 1.450698464000000e+04, 1.444849319000000e+04, 1.440005683000000e+04, 1.434737005000000e+04, 1.422074809000000e+04, 1.406196029000000e+04, 1.401204841000000e+04, 1.391428627000000e+04, 1.384594549000000e+04, 1.305869979000000e+04, 1.102306510000000e+04, 8.957334316000000e+03, 7.942463609000000e+03, 7.509811423000000e+03, 6.372333331000000e+03, 5.703773653000000e+03],
)]

gmres_list += [GMRES(
fill=9,
iter=[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140],
resids=[1.494955760000000e+04, 1.485705686000000e+04, 1.482309514000000e+04, 1.481650985000000e+04, 1.458910949000000e+04, 1.452418197000000e+04, 1.421921774000000e+04, 1.304409567000000e+04, 1.041103746000000e+04, 9.499808852000000e+03, 9.019470883000000e+03, 5.002459576000000e+03, 3.464869084000000e+03, 9.151489466999999e+00, 4.718457973000000e-04],
)]

# Plotting
plt.figure(figsize=(8, 6))

for gmres in gmres_list:
    plt.semilogy(gmres.iter, gmres.resids, marker='o', label=f'fill = {gmres.fill}')

plt.xlabel('GMRES Iteration')
plt.ylabel('Residual Norm')
# plt.title('GMRES Convergence History')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.tight_layout()
# plt.show()
plt.savefig("out/ucrm-gmres.png", dpi=400)
