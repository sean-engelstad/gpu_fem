import numpy as np
import matplotlib.pyplot as plt
import niceplots

resid_hist = np.array([1.41421e-01,1.03164e+02,2.29489e-01,2.50006e+01,1.72495e-01,6.09898e+00,3.14125e-01,9.28629e-01,1.98264e-01,8.62896e-02,2.34637e-02,6.07854e-03,1.53059e-03,3.99710e-04,1.20173e-04,4.59036e-05,2.09313e-05,1.01872e-05,5.03852e-06,2.49944e-06,1.24014e-06,6.15176e-07,3.05106e-07,1.51303e-07,1.41421e-01,1.00105e+02,2.20988e-01,2.24788e+01,1.81219e-01,4.96640e+00,3.11194e-01,6.39588e-01,1.41016e-01,4.83986e-02,1.18616e-02,2.77131e-03,6.48736e-04,1.68457e-04,5.64778e-05,2.40889e-05,1.12662e-05,5.37159e-06,2.56602e-06,1.22484e-06,5.84216e-07,2.78537e-07,1.32759e-07,1.41421e-01,9.21158e+01,1.98612e-01,1.87455e+01,1.94796e-01,3.47967e+00,2.87285e-01,3.36524e-01,7.32095e-02,1.85372e-02,3.88761e-03,8.00594e-04,1.81253e-04,5.51211e-05,2.23200e-05,9.93142e-06,4.47989e-06,2.01915e-06,9.08480e-07,4.08309e-07,1.83418e-07,1.41421e-01,8.17262e+01,1.72441e-01,1.49096e+01,2.09485e-01,2.19802e+00,2.30470e-01,1.45477e-01,2.84523e-02,5.45918e-03,9.68243e-04,1.87379e-04,5.14679e-05,1.96867e-05,8.21323e-06,3.44892e-06,1.44391e-06,6.03187e-07,2.51694e-07,1.04994e-07,1.41421e-01,7.11022e+01,1.50187e-01,1.16001e+01,2.19899e-01,1.30562e+00,1.57006e-01,5.58433e-02,9.10712e-03,1.38650e-03,2.21171e-04,5.21548e-05,1.83830e-05,7.08101e-06,2.73196e-06,1.04939e-06,4.02131e-07,1.53945e-07,1.41421e-01,6.14135e+01,1.34767e-01,8.98421e+00,2.21826e-01,7.51134e-01,9.29764e-02,2.02767e-02,2.65309e-03,3.38555e-04,6.20534e-05,1.92910e-05,6.75944e-06,2.36645e-06,8.23759e-07,2.86012e-07,1.41421e-01,5.30576e+01,1.26133e-01,6.99716e+00,2.14231e-01,4.26291e-01,4.98524e-02,7.22534e-03,7.49384e-04,9.45944e-05,2.36380e-05,7.38931e-06,2.31015e-06,7.16581e-07,2.21583e-07,1.41421e-01,4.60320e+01,1.23277e-01,5.50746e+00,1.98916e-01,2.41256e-01,2.50637e-02,2.55172e-03,2.17201e-04,3.53535e-05,9.47155e-06,2.57446e-06,6.90855e-07,1.84598e-07,1.41421e-01,4.01794e+01,1.25106e-01,4.38931e+00,1.78940e-01,1.36980e-01,1.20670e-02,8.87320e-04,7.36652e-05,1.48560e-05,3.33087e-06,7.21569e-07,1.54555e-07,1.41421e-01,3.53078e+01,1.30629e-01,3.54288e+00,1.57220e-01,7.82520e-02,5.60354e-03,3.04859e-04,3.18991e-05,5.58737e-06,8.26359e-07,1.02573e-07,1.41421e-01,3.12380e+01,1.38961e-01,2.89454e+00,1.35870e-01,4.50044e-02,2.49735e-03,1.13932e-04,1.53785e-05,2.01046e-06,3.43253e-07,1.41421e-01,2.78182e+01,1.49330e-01,2.39149e+00,1.16135e-01,2.60244e-02,1.05364e-03,5.73730e-05,8.87665e-06,1.91685e-06,4.50772e-07,1.41421e-01,2.49253e+01,1.61090e-01,1.99610e+00,9.85768e-02,1.50869e-02,4.23509e-04,3.87661e-05,8.26087e-06,2.08283e-06,4.08808e-07,1.41421e-01,2.24608e+01,1.73722e-01,1.68152e+00,8.33262e-02,8.73048e-03,2.03980e-04,3.52679e-05,9.28493e-06,2.06128e-06,4.23704e-07,1.09192e-07,1.41421e-01,2.03466e+01,1.86817e-01,1.42837e+00,7.02725e-02,5.02184e-03,1.74293e-04,4.12681e-05,1.05684e-05,2.28697e-06,5.85040e-07,1.50693e-07,1.41421e-01,1.85208e+01,2.00057e-01,1.22255e+00,5.91954e-02,2.87976e-03,1.89368e-04,5.05438e-05,1.22706e-05,2.96269e-06,8.30776e-07,2.03103e-07,1.41421e-01,1.69339e+01,2.13197e-01,1.05364e+00,4.98407e-02,1.70997e-03,2.14510e-04,6.00737e-05,1.45771e-05,3.97057e-06,1.11988e-06,2.76930e-07,1.41421e-01,1.55465e+01,2.26049e-01,9.13822e-01,4.19597e-02,1.18741e-03,2.45745e-04,6.90967e-05,1.74653e-05,5.16567e-06,1.44459e-06,3.78872e-07,1.13410e-07,1.41421e-01,1.43267e+01,2.38468e-01,7.97209e-01,3.53274e-02,1.06082e-03,2.79318e-04,7.75846e-05,2.08165e-05,6.46744e-06,1.80789e-06,5.10168e-07,1.57142e-07,1.41421e-01,1.32486e+01,2.50342e-01,6.99265e-01,2.97489e-02,1.09278e-03,3.12034e-04,8.56922e-05,2.45129e-05,7.83645e-06,2.21522e-06,6.69458e-07,2.07940e-07])
iterations = np.array([_ for _ in range(resid_hist.shape[0])])
plt.style.use(niceplots.get_style())
plt.plot(iterations, resid_hist, 'o-')
plt.yscale('log')
plt.ylabel("Resid norm")
plt.margins(x=0.05, y=0.05)
# plt.show()
plt.savefig("nl-resid-hist.svg", dpi=400)